% PLEASE USE THIS FILE AS A TEMPLATE
% Check file iosart2c.tex for more examples
%
% Journal:
%   Journal of Ambient Intelligence and Smart Environments (jaise)
%   Web Intelligence and Agent Systems: An International Journal (wias)
%   Semantic Web: Interoperability, Usability, Applicability (SW)
% IOS Press
% Latex 2e

% options: jaise|wias|sw
% add. options: [seceqn,secfloat,secthm,crcready,onecolumn]


\documentclass[sw]{iosart2c}

%\documentclass[sw]{iosart2c}
%\documentclass[wias]{iosart2c}
%\documentclass[jaise]{iosart2c}

\usepackage[T1]{fontenc}
\usepackage{times}%
\usepackage{natbib}% for bibliography sorting/compressing
%\usepackage{amsmath}
%\usepackage{endnotes}
\usepackage{graphicx}
%\usepackage{tikz}
%\usetikzlibrary{snakes,arrows,shapes}

%%%%%%%%%%% Put your definitions here

\bibliographystyle{plain} 

%%%%%%%%%%% End of definitions

\pubyear{0000}
\volume{0}
\firstpage{1}
\lastpage{1}

\begin{document}

\begin{frontmatter}

%\pretitle{}
\title{The ChEMBL database as Linked Open Data}
\runningtitle{ChEMBL-RDF}
%\subtitle{}

%\review{}{}{}


% For one author:
\author[A]{\fnms{Egon} \snm{Willighagen}} % \thanks{Huh?}}
\address[A]{Maastricht University}
\runningauthor{E.L. Willighagen et al.}

% Two or more authors (order to be determined):
\author[B]{\fnms{Ola} \snm{Spjuth}},
\address[B]{Uppsala University}

\author[C]{\fnms{Peter} \snm{Ansell}},
\address[C]{University of Queensland}

\author[D]{\fnms{Antony} \snm{Williams}},
\address[D]{xxx}

\author[E]{\fnms{John} \snm{Overington}},
\author[E]{\fnms{Anna} \snm{Gaulton}},
\address[E]{European Bioinformatics Institute}

%\author[B]{\fnms{} \snm{}}
%\runningauthor{}
%\address[A]{}

\begin{abstract}
This paper describes the continued conversion of ChEMBL data into RDF triples, using a few existing
ontologis, and demonstrates a few new use cases, taking advantage of its linked nature.
\end{abstract}

\begin{keyword}
% \sep 
Resource Description Framework, ChEMBL
\end{keyword}

\end{frontmatter}

%%%%%%%%%%% The article body starts:

\section{Introduction}\label{s1}

Linked Data, pharmaceutical research, Open PHACTS, ...

This data set has been previously used in~\cite{Willighagen2011} and in Foo where the data is used
in the Foo framework (book chapter...)

%\subsection{}\label{s1.1}

\section{Methods}\label{s2}

The ChEMBL version used in this paper is ChEMBL 13, which was released on February 29 2011....

The RDF triples were generated from the a local MySQL chembl\_13 database populated with a stock
SQL dump of ChEMBL 13. PHP scripts were used to create N-Triples files. The source code is
available under a XXX license from https://github.com/egonw/chembl.rdf.

\subsection{Ontologies}

Ontologies... CHEMINF, ...

The BIBO ontology is used to represent documents.

Throughout this paper, various prefixes are used to simplify RDF output, outlined
in Table~\ref{namespaces}.

\subsection{Use cases}

A few new uses cases have been developed for this paper to demonstrate not just the intrinsic
value of the data in the ChEMBL database as done previously, but also to show the possibilities
the Linked Data nature offers.

... describe what we want to show ...

\section{Results}\label{s3}

\subsection{Data Statistics}

\# triples
\# links out
\# problems

The full set of triples are available from http://semantics.bigcat.unimaas.nl/chembl12/.

FIXME!

\subsection{Data Structure}

For each of the common resource classes a triple pattern was defined, following the
data available in the relational database.

Assays .... anything

\begin{small}
\begin{verbatim}
assay:a17
 a chembl:Assay ;
 chembl:extractedFrom
  res:r11347 ;
 chembl:hasAssayType chembl:ADMET ;
 chembl:hasConfScore "7"^^xsd:int ;
 chembl:hasDescription
  "Inhibition of cytochrome P450 progesterone 15-alpha hydroxylase" ;
 chembl:hasTarget target:t100122 .
\end{verbatim}
\end{small}

Targets ... protein, other

\begin{small}
\begin{verbatim}
target:t1
 a chembl:Target ;
 rdfs:subClassOf pro:PR_000000001 ;
 rdfs:label "Glucoamylase" , 
  "Maltase-glucoamylase, intestinal" ;
 dc:identifier "uniprot:O43451" , "3.2.1.3" ;
 dc:title "Maltase-glucoamylase" ;
 chembl:classL1 "Enzyme" ;
 chembl:hasDescription
  "Maltase-glucoamylase, intestinal" ;
 chembl:hasKeyword "Glycosidase" , 
  "Membrane" , "Sulfation" ;
 chembl:hasTaxonomy
  <http://bio2rdf.org/taxonomy:9606> ;
 chembl:organism "Homo sapiens" ;
 = <http://bio2rdf.org/uniprot:O43451> , 
   <http://bio2rdf.org/ec:3.2.1.3> .
\end{verbatim}
\end{small}

Activities ...

\begin{small}
\begin{verbatim}
act:a31863
 a       chembl:Activity ;
 cito:citesAsDataSource
  res:r6424 ;
 chembl:forMolecule mol:m180094 ;
 chembl:onAssay assay:a54505 ;
 chembl:relation ">" ;
 chembl:standardUnits
  "nM" ;
 chembl:standardValue
  "100000"^^xsd:float ;
 chembl:type "IC50" .
\end{verbatim}
\end{small}

Compounds ... Three types of compounds, peptides, small chemicals, ...

\begin{tiny}
\begin{verbatim}
m41:inchikey
      a       cheminf:CHEMINF_000059 ;
      cheminf:SIO_000300 "LMCOMIDLRGMFCZ-RIPOXUOASA-N" .

m41:smiles
      a       cheminf:CHEMINF_000018 ;
      cheminf:SIO_000300 "CC(C)C[C@@H]1N2C=CC(NC(=O)[C@H](Cc3ccccc3)N(C)C(=O)C(Cc4c[nH]c5ccccc45)NC(=O)C(CCC(=O)N)NC(=O)[C@@H](CCSCCSCC[C@H]6NC(=O)[C@H](CC(C)C)N7C=CC(NC(=O)[C@H](Cc8ccccc8)N(C)C(=O)C(Cc9c[nH]c%10ccccc9%10)NC(=O)C(CCC(=O)N)NC6=O)C7=O)NC1=O)C2=O" .

m41:inchi
      a       cheminf:CHEMINF_000113 ;
      cheminf:SIO_000300 "InChI=1S/C82H102N16O14S2/c1-47(2)39-67-77(107)89-59(73(103)87-57(25-27-69(83)99)71(101)93-63(43-51-45-85-55-23-15-13-21-53(51)55)79(109)95(5)65(41-49-17-9-7-10-18-49)75(105)91-61-29-33-97(67)81(61)111)31-35-113-37-38-114-36-32-60-74(104)88-58(26-28-70(84)100)72(102)94-64(44-52-46-86-56-24-16-14-22-54(52)56)80(110)96(6)66(42-50-19-11-8-12-20-50)76(106)92-62-30-34-98(82(62)112)68(40-48(3)4)78(108)90-60/h7-24,29-30,33-34,45-48,57-68,85-86H,25-28,31-32,35-44H2,1-6H3,(H2,83,99)(H2,84,100)(H,87,103)(H,88,104)(H,89,107)(H,90,108)(H,91,105)(H,92,106)(H,93,101)(H,94,102)/t57?,58?,59-,60-,61?,62?,63?,64?,65+,66+,67+,68+/m1/s1" .

chemblid:CHEMBL406142
      owl:equivalentClass mol:m41 .

mol:m41
      rdfs:label "CHEMBL406142" , "Bis(3-[14-Benzyl-11-(1H-indol-3-ylmethyl)-2-isobutyl-13-methyl-5-(2-methylsulfanyl-ethyl)-3,6,9,12,15,20-hexaoxo-1,4,7,10,13,16-hexaaza-bicyclo[15.2.1]icos-18-en-8-yl]-propionamide)" ;
      rdfs:subClassOf cheminf:CHEMINF_000000 ;
      cheminf:CHEMINF_000200
              m41:inchikey , m41:smiles , m41:inchi ;
      <http://www.blueobelisk.org/chemistryblogs/inchi>
              "InChI=1S/C82H102N16O14S2/c1-47(2)39-67-77(107)89-59(73(103)87-57(25-27-69(83)99)71(101)93-63(43-51-45-85-55-23-15-13-21-53(51)55)79(109)95(5)65(41-49-17-9-7-10-18-49)75(105)91-61-29-33-97(67)81(61)111)31-35-113-37-38-114-36-32-60-74(104)88-58(26-28-70(84)100)72(102)94-64(44-52-46-86-56-24-16-14-22-54(52)56)80(110)96(6)66(42-50-19-11-8-12-20-50)76(106)92-62-30-34-98(82(62)112)68(40-48(3)4)78(108)90-60/h7-24,29-30,33-34,45-48,57-68,85-86H,25-28,31-32,35-44H2,1-6H3,(H2,83,99)(H2,84,100)(H,87,103)(H,88,104)(H,89,107)(H,90,108)(H,91,105)(H,92,106)(H,93,101)(H,94,102)/t57?,58?,59-,60-,61?,62?,63?,64?,65+,66+,67+,68+/m1/s1" ;
      owl:equivalentClass <http://rdf.openmolecules.net/?InChI=1S/C82H102N16O14S2/c1-47(2)39-67-77(107)89-59(73(103)87-57(25-27-69(83)99)71(101)93-63(43-51-45-85-55-23-15-13-21-53(51)55)79(109)95(5)65(41-49-17-9-7-10-18-49)75(105)91-61-29-33-97(67)81(61)111)31-35-113-37-38-114-36-32-60-74(104)88-58(26-28-70(84)100)72(102)94-64(44-52-46-86-56-24-16-14-22-54(52)56)80(110)96(6)66(42-50-19-11-8-12-20-50)76(106)92-62-30-34-98(82(62)112)68(40-48(3)4)78(108)90-60/h7-24,29-30,33-34,45-48,57-68,85-86H,25-28,31-32,35-44H2,1-6H3,(H2,83,99)(H2,84,100)(H,87,103)(H,88,104)(H,89,107)(H,90,108)(H,91,105)(H,92,106)(H,93,101)(H,94,102)/t57?,58?,59-,60-,61?,62?,63?,64?,65+,66+,67+,68+/m1/s1> , <http://bio2rdf.org/chebi:100041> , chemblid:CHEMBL406142 .
\end{verbatim}
\end{tiny}

For documents little information is replicated from the database, taking advantage
of PubMed Identifiers (PMIDs) and Digital Object Identifiers (DOIs). URIs for the
latter can be resolved online, providing curated information on the identified
documents. For PubMed articles ...

\begin{tiny}
\begin{verbatim}
journal:j6c706049c2e08871b7c46a6528065736
 a bibo:Journal ;
 dc:title "J. Med. Chem." .

res:r1
 a bibo:Article ;
 rdfs:seeAlso <http://bio2rdf.org/pubmed:14695813> ;
 dc:date "2004" ;
 dc:isPartOf journal:j6c706049c2e08871b7c46a6528065736 ;
 bibo:issue "1" ;
 bibo:pageEnd "9" ;
 bibo:pageStart "1" ;
 bibo:pmid "14695813" ;
 bibo:volume "47" .
\end{verbatim}
\end{tiny}

\subsection{SPARQL end points}

Previously, a SPARQL end point has been set up at Uppsala University.

\subsubsection{Bio2RDF}

Peter: write up the proxying... if that still works...

The Bio2RDF project provides both resolvable Linked Data URIs using a generic Linked Data server \cite{Ansell2011}, and access to SPARQL endpoints for a range of scientific databases \cite{Belleau2008}. A number of these databases are referenced in Chembl, including Chebi, Pubmed, and both the Uniprot protein and taxonomy databases \cite{TheUniProtConsortium2010}. These links are vital to provide context for users who need to query across both Chembl and its related databases. The Linked Data server used by Bio2RDF has been configured for Chembl to provide URL based services for text and link searches.

\subsubsection{Data Statistics and Validation}

John/Anna: common statistics with SPARQL

%\subsubsection{CitedIn}

%Andra: use the SPARQL end point to find which entries in ChEMBL cite what papers
 
%The link between data and formal publication is important in many areas of
%attribution, scientist ranking, etc, as outline in \cite{Waagmeester2012}.
%ChEMBL contains many literature references, and we wish to query this data
%for CitedIn.

\subsubsection{Decision Support}

Egon,Antony/Valery,Ola: develop and write up the Bioclipse Decision Support use case

\subsection{Linked Data on Kasabi}

Later, to satisfy the requirements for the Linked Open Drug Data \cite{Samwald2011}
network, the data was also hosted on Kasabi, a triple store hosting service
free for Open Data~\cite{kasabi}.

David: Chem2Bio2RDF

%\subsection{Use Case 2: Chem2Bio2RDF}

%David: Chem2Bio2RDF

\subsubsection{Linking out to ChemSpider}

Antony: if you can contribute ChemSpider IDs for the ChEMBL compounds ...

\subsubsection{Linking out to ChEMBL}

John/Anna: I can easily add links to webpages using foaf:homepage... are webpage URLs for entities stable enough?

\subsubsection{Linking out to Bio2RDF}

Peter/Egon: write up links to Bio2RDF for protein, pubmed, ...

\section{Discussion}

outlook ...

\section{Acknowledgements}

Tim and Foo of Kasabi. What S.H. Name of the Bioinformatics department at Uppsala University.

\begin{figure}[t]
\includegraphics[width=0.5\textwidth]{figs/relations}
\caption{The various resource types found in the ChEMBL triples. Some entities are subclasses
of common classes, while others are instances.}\label{f1}
\end{figure}

\begin{table*}
\caption{Prefixes and their matching namespaces used in this paper.} \label{namespaces}
\begin{tabular}{ll}
\hline
Common & Vocabularies \\
cito    & Citation Typing Ontology~\cite{Shotton2010} \\
        & http://purl.org/spar/cito/ \\
cheminf & Chemical Information Ontology~\cite{Hastings2011} \\
        & http://semanticscience.org/resource/ \\
bibo    & Bibliography Ontology~\cite{Giasson2011} \\
        & http://purl.org/ontology/bibo/ \\

\hline
ChEMBL-RDF & Namespaces\\
act    & http://data.kasabi.com/dataset/chembl-rdf/activity/ \\
chembl & http://rdf.farmbio.uu.se/chembl/onto/\# \\
res    & http://data.kasabi.com/dataset/chembl-rdf/resource/ \\
assay  & http://data.kasabi.com/dataset/chembl-rdf/assay/ \\
mol    & http://data.kasabi.com/dataset/chembl-rdf/molecule/ \\
\hline
\end{tabular}
\end{table*}

\bibliography{article}

%%%%%%%%%%% The bibliography starts:
%\begin{thebibliography}{9}
%
%\bibitem{r1}
%
%\bibitem{r2}
%
%\end{thebibliography}

\end{document}
